<!doctype html>
<html lang="zh-cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.84.3" /><META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
<link rel="shortcut icon" href="/favicon.png" >
<link rel="apple-touch-icon" href="/favicon.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicon.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicon.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicon.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicon.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicon.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicon.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicon.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicon.png" sizes="192x192">

<title>Manage Helm Releases | 道场</title>
<meta name="description" content="Open and extensible continuous delivery solution for Kubernetes."><meta property="og:title" content="Manage Helm Releases" />
<meta property="og:description" content="Manage Helm Releases in a declarative manner with Flux." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/docs/iac/helmreleases/" /><meta property="og:image" content="/img/flux-social.png"/><meta property="article:section" content="docs" />



<meta itemprop="name" content="Manage Helm Releases">
<meta itemprop="description" content="Manage Helm Releases in a declarative manner with Flux.">

<meta itemprop="wordCount" content="1605"><meta itemprop="image" content="/img/flux-social.png"/>
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/img/flux-social.png"/>

<meta name="twitter:title" content="Manage Helm Releases"/>
<meta name="twitter:description" content="Manage Helm Releases in a declarative manner with Flux."/>




<link rel="preload" href="/scss/main.min.4a9db146ac33069ee85be0885ccf5f1ce3a4387f774ad3c60af13d7316e8cedc.css" as="style">
<link href="/scss/main.min.4a9db146ac33069ee85be0885ccf5f1ce3a4387f774ad3c60af13d7316e8cedc.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />





  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"><svg width="64" height="64" viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>flux-icon</title><desc>Created with Sketch.</desc><g id="flux-icon" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Group" transform="translate(11.000000, 2.000000)"><path d="M.803134615 15.7791346c-1.049423077-.682500000000001-1.049423077-2.2188461.0-2.9007692L20.1819808.279519231c.573461499999997-.3726923079 1.3125-.3726923079 1.8859615.0L41.4473654 12.8783654c1.0494231.681923100000001 1.0494231 2.2182692.0 2.9007692L22.0679423 28.3779808C21.4944808 28.7506731 20.7554423 28.7506731 20.1819808 28.3779808L.803134615 15.7791346z" id="Fill-1" fill="#326ce5"/><path d="M24.1851346 18.0023077h1.3442308C26.3145577 18.0023077 26.8055192 17.1525 26.4126346 16.4728846L22.0084038 8.84423077C21.6160962 8.16461538 20.63475 8.16461538 20.2418654 8.84423077L15.8376346 16.4728846C15.4453269 17.1525 15.9357115 18.0023077 16.7209038 18.0023077h1.3448077c.563077.0 1.0194231.456923100000001 1.0194231 1.02v8.7075L19.9874423 28.3165385C20.6791731 28.7665385 21.5710962 28.7665385 22.2628269 28.3165385L23.1651346 27.7298077v-8.7075c0-.563076899999999.456346200000002-1.02 1.02-1.02" id="Fill-3" fill="#c1d2f7"/><path d="M27.8390769 34.8375577l-4.6742307-3.0386539v1.44C24.6902308 33.8919808 26.2588846 34.4008269 27.8390769 34.8375577" id="Fill-5" fill="#326ce5"/><path d="M23.1650769 35.8280192v2.0215385C24.7095 38.3209038 26.2723846 38.7080192 27.8191154 39.0893654c5.0515384 1.2455769 9.8226923 2.4213461 13.6592308 6.2584615C41.6733462 45.54225 41.8562308 45.7407115 42.0373846 45.93975 42.4308462 45.1880192 42.2335385 44.1957115 41.4466154 43.6845577l-7.5905769-4.9355769c-1.8426923-.608077000000002-3.72-1.073077-5.5753847-1.53C26.5308462 36.7874423 24.8196923 36.3570577 23.1650769 35.8280192" id="Fill-7" fill="#326ce5"/><path d="M19.08525 34.1699423C18.4304423 33.8318654 17.7854423 33.4689808 17.1629423 33.0489808l-1.7359615 1.1284615c1.1705769.8607692 2.3965384 1.5588462 3.6582692 2.1438462V34.1699423z" id="Fill-9" fill="#326ce5"/><path d="M24.8941731 40.6051154C24.3137885 40.4620385 23.7374423 40.3195385 23.1651346 40.1735769V42.1605C23.5885962 42.2666538 24.0114808 42.3722308 24.4326346 42.4760769c5.0515385 1.245 9.8226923 2.4207693 13.6598077 6.2578846C38.0987885 48.7408846 38.1045577 48.7472308 38.1114808 48.7541538L39.75225 47.6868462C39.6524423 47.5824231 39.5584038 47.4751154 39.4545577 47.3718462c-4.2161539-4.2167308-9.4753846-5.513077-14.5603846-6.7667308" id="Fill-11" fill="#326ce5"/><path d="M19.08525 38.9907115C16.8900577 38.2389808 14.8096731 37.2714808 12.9115962 35.8124423l-1.6996154 1.1053846c2.4167307 1.9932693 5.1075 3.2025 7.8732692 4.0990385V38.9907115z" id="Fill-13" fill="#326ce5"/><path d="M19.08525 43.3809808C15.3069808 42.3909808 11.7537115 41.18175 8.71794231 38.5388654L7.04717308 39.6252115c3.56538462 3.285 7.80692312 4.658077 12.03807692 5.745577V43.3809808z" id="Fill-15" fill="#326ce5"/><path d="M23.1650769 46.3935c3.9525 1.02057689999999 7.6690385 2.2407692 10.8173077 5.0446154l1.6615385-1.08c-3.6784616-3.4580769-8.0925-4.8386539-12.4788462-5.9532692V46.3935z" id="Fill-17" fill="#326ce5"/><path d="M4.57875 41.2299231 2.92990385 42.3018462C2.98759615 42.3612692 3.04009615 42.423 3.09951923 42.4818462 7.31625 46.6985769 12.5743269 47.9949231 17.6599038 49.2485769c4.4042308 1.0851923 8.5944231 2.1201923 12.1390385 4.9096154L31.4893269 53.0591538C27.4958654 49.6968462 22.7385577 48.5158846 18.1214423 47.3781923 13.1206731 46.1453077 8.39567308 44.9758846 4.57875 41.2299231" id="Fill-19" fill="#326ce5"/><path d="M1.07555769 44.5060962C.883442308 44.3139808.702865385 44.1184038.524019231 43.9216731-.227711538 44.6745577-.139442308 45.9726346.80325 46.5853269l5.70634615 3.7101923c2.52576923 1.0453846 5.16692305 1.6990385 7.76423075 2.3394231 4.0546154.999230799999999 7.9280769 1.9575 11.2840385 4.2807692l1.7255769-1.1226923C23.4676731 52.9245577 19.0403654 51.8255192 14.7347885 50.7639808c-5.05096158-1.245-9.82211542-2.4207693-13.65923081-6.2578846" id="Fill-21" fill="#326ce5"/><path d="M19.6441154 58.8342692C20.0243077 59.0188846 20.3998846 59.2133077 20.7691154 59.4221538 21.2093077 59.5150385 21.6771923 59.4383077 22.0683462 59.1838846L23.0260385 58.5613846C19.9493077 56.5035 16.5287308 55.461 13.1196923 54.5927308l6.5244231 4.2415384z" id="Fill-23" fill="#326ce5"/></g></g></svg></span><span class="text-uppercase font-weight-bold">道场</span>
	</a>
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link" href="/docs" ><span>修习</span></a>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				
				<a class="nav-link" href="/blog/" ><span>动态</span></a>
				
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/devopschina/sig/" target="_blank" ><i class='fab fa-github'></i> <span>Github</span></a>
				
			</li>
			
			
			
			<li class="nav-item nav-search-item">
<input type="search" class="form-control td-search-input" placeholder="&#xf002; " aria-label="" autocomplete="off">

</li>
		</ul>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




  


<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <div id="content-mobile">
  <form class="td-sidebar__search d-flex align-items-center">
    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  </div>
  <div id="content-desktop"></div>
  
  <nav class="collapse td-sidebar-nav foldable-nav" id="td-section-nav">
    
    
    
    
    
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
    
      <a href="/docs/" title="入门指南" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">道场</span></a>
    
    
      
      <ul class="ul-1">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsconcepts-li">
    
      <input type="checkbox" id="m-docsconcepts-check"/>
      <label for="m-docsconcepts-check"><a href="/docs/concepts/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsconcepts"><span class="">核心概念</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsget-started-li">
    
      <input type="checkbox" id="m-docsget-started-check"/>
      <label for="m-docsget-started-check"><a href="/docs/get-started/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsget-started"><span class="">转型方法</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docstool-chain-li">
    
      <input type="checkbox" id="m-docstool-chain-check"/>
      <label for="m-docstool-chain-check"><a href="/docs/tool-chain/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docstool-chain"><span class="">工具链</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsiac-li">
    
      <input type="checkbox" id="m-docsiac-check" checked/>
      <label for="m-docsiac-check"><a href="/docs/iac/" title="基础设施即代码" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsiac"><span class="">IaC</span></a></label>
    
    
      
      <ul class="ul-2 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacrepository-structure-li">
    
      <input type="checkbox" id="m-docsiacrepository-structure-check"/>
      <label for="m-docsiacrepository-structure-check"><a href="/docs/iac/repository-structure/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacrepository-structure"><span class="">Ways of structuring your repositories</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsiachelmreleases-li">
    
      <input type="checkbox" id="m-docsiachelmreleases-check" checked/>
      <label for="m-docsiachelmreleases-check"><a href="/docs/iac/helmreleases/" class="align-left pl-0  active td-sidebar-link td-sidebar-link__page" id="m-docsiachelmreleases"><span class="td-sidebar-nav-active-item">Manage Helm Releases</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacnotifications-li">
    
      <input type="checkbox" id="m-docsiacnotifications-check"/>
      <label for="m-docsiacnotifications-check"><a href="/docs/iac/notifications/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacnotifications"><span class="">Setup Notifications</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacwebhook-receivers-li">
    
      <input type="checkbox" id="m-docsiacwebhook-receivers-check"/>
      <label for="m-docsiacwebhook-receivers-check"><a href="/docs/iac/webhook-receivers/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacwebhook-receivers"><span class="">Setup Webhook Receivers</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacmonitoring-li">
    
      <input type="checkbox" id="m-docsiacmonitoring-check"/>
      <label for="m-docsiacmonitoring-check"><a href="/docs/iac/monitoring/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacmonitoring"><span class="">Monitoring with Prometheus</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacsealed-secrets-li">
    
      <input type="checkbox" id="m-docsiacsealed-secrets-check"/>
      <label for="m-docsiacsealed-secrets-check"><a href="/docs/iac/sealed-secrets/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacsealed-secrets"><span class="">Sealed Secrets</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacmozilla-sops-li">
    
      <input type="checkbox" id="m-docsiacmozilla-sops-check"/>
      <label for="m-docsiacmozilla-sops-check"><a href="/docs/iac/mozilla-sops/" title="Manage Kubernetes secrets with Mozilla SOPS" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacmozilla-sops"><span class="">Mozilla SOPS</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacimage-update-li">
    
      <input type="checkbox" id="m-docsiacimage-update-check"/>
      <label for="m-docsiacimage-update-check"><a href="/docs/iac/image-update/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacimage-update"><span class="">Automate image updates to Git</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsiacsortable-image-tags-li">
    
      <input type="checkbox" id="m-docsiacsortable-image-tags-check"/>
      <label for="m-docsiacsortable-image-tags-check"><a href="/docs/iac/sortable-image-tags/" title="How to make sortable image tags to use with automation" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsiacsortable-image-tags"><span class="">Sortable image tags to use with automation</span></a></label>
    
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsagile-li">
    
      <input type="checkbox" id="m-docsagile-check"/>
      <label for="m-docsagile-check"><a href="/docs/agile/" title="敏捷道场" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagile"><span class="">Agile</span></a></label>
    
    
      
      <ul class="ul-2 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsagilesource-li">
    
      <input type="checkbox" id="m-docsagilesource-check"/>
      <label for="m-docsagilesource-check"><a href="/docs/agile/source/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagilesource"><span class="">Source Controller</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsagilekustomize-li">
    
      <input type="checkbox" id="m-docsagilekustomize-check"/>
      <label for="m-docsagilekustomize-check"><a href="/docs/agile/kustomize/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagilekustomize"><span class="">Kustomize Controller</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsagilehelm-li">
    
      <input type="checkbox" id="m-docsagilehelm-check"/>
      <label for="m-docsagilehelm-check"><a href="/docs/agile/helm/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagilehelm"><span class="">Helm Controller</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsagilenotification-li">
    
      <input type="checkbox" id="m-docsagilenotification-check"/>
      <label for="m-docsagilenotification-check"><a href="/docs/agile/notification/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagilenotification"><span class="">Notification Controller</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsagileimage-li">
    
      <input type="checkbox" id="m-docsagileimage-check"/>
      <label for="m-docsagileimage-check"><a href="/docs/agile/image/" title="Image reflector and automation controllers" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsagileimage"><span class="">Image Automation Controllers</span></a></label>
    
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgitops-toolkit-li">
    
      <input type="checkbox" id="m-docsgitops-toolkit-check"/>
      <label for="m-docsgitops-toolkit-check"><a href="/docs/gitops-toolkit/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsgitops-toolkit"><span class="">Toolkit Dev Guides</span></a></label>
    
    
      
      <ul class="ul-2 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitops-toolkitpackages-li">
    
      <input type="checkbox" id="m-docsgitops-toolkitpackages-check"/>
      <label for="m-docsgitops-toolkitpackages-check"><a href="/docs/gitops-toolkit/packages/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitops-toolkitpackages"><span class="">Using the GitOps Toolkit APIs with Go</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitops-toolkitsource-watcher-li">
    
      <input type="checkbox" id="m-docsgitops-toolkitsource-watcher-check"/>
      <label for="m-docsgitops-toolkitsource-watcher-check"><a href="/docs/gitops-toolkit/source-watcher/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitops-toolkitsource-watcher"><span class="">Watching for source changes</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitops-toolkitdebugging-li">
    
      <input type="checkbox" id="m-docsgitops-toolkitdebugging-check"/>
      <label for="m-docsgitops-toolkitdebugging-check"><a href="/docs/gitops-toolkit/debugging/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitops-toolkitdebugging"><span class="">Advanced debugging</span></a></label>
    
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsgitops-li">
    
      <input type="checkbox" id="m-docsgitops-check"/>
      <label for="m-docsgitops-check"><a href="/docs/gitops/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docsgitops"><span class="">GitOps</span></a></label>
    
    
      
      <ul class="ul-2 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitopspackages-li">
    
      <input type="checkbox" id="m-docsgitopspackages-check"/>
      <label for="m-docsgitopspackages-check"><a href="/docs/gitops/packages/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitopspackages"><span class="">Using the GitOps Toolkit APIs with Go</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitopssource-watcher-li">
    
      <input type="checkbox" id="m-docsgitopssource-watcher-check"/>
      <label for="m-docsgitopssource-watcher-check"><a href="/docs/gitops/source-watcher/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitopssource-watcher"><span class="">Watching for source changes</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsgitopsdebugging-li">
    
      <input type="checkbox" id="m-docsgitopsdebugging-check"/>
      <label for="m-docsgitopsdebugging-check"><a href="/docs/gitops/debugging/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsgitopsdebugging"><span class="">Advanced debugging</span></a></label>
    
    
  </li>

          
        
      </ul>
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsroadmap-li">
    
      <input type="checkbox" id="m-docsroadmap-check"/>
      <label for="m-docsroadmap-check"><a href="/docs/roadmap/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsroadmap"><span class="">Roadmap</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsfaq-li">
    
      <input type="checkbox" id="m-docsfaq-check"/>
      <label for="m-docsfaq-check"><a href="/docs/faq/" title="Frequently asked questions" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docsfaq"><span class="">FAQ</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docscontributing-li">
    
      <input type="checkbox" id="m-docscontributing-check"/>
      <label for="m-docscontributing-check"><a href="/docs/contributing/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docscontributing"><span class="">Contributing</span></a></label>
    
    
      
      <ul class="ul-2 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docscontributingdocs-li">
    
      <input type="checkbox" id="m-docscontributingdocs-check"/>
      <label for="m-docscontributingdocs-check"><a href="/docs/contributing/docs/" class="align-left pl-0  td-sidebar-link td-sidebar-link__section" id="m-docscontributingdocs"><span class="">Documentation</span></a></label>
    
    
      
      <ul class="ul-3 foldable">
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontributingdocssome-background-li">
    
      <input type="checkbox" id="m-docscontributingdocssome-background-check"/>
      <label for="m-docscontributingdocssome-background-check"><a href="/docs/contributing/docs/some-background/" title="Where to find the docs and how to contribute" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docscontributingdocssome-background"><span class="">Some background</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontributingdocsproposing-changes-li">
    
      <input type="checkbox" id="m-docscontributingdocsproposing-changes-check"/>
      <label for="m-docscontributingdocsproposing-changes-check"><a href="/docs/contributing/docs/proposing-changes/" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docscontributingdocsproposing-changes"><span class="">Proposing changes</span></a></label>
    
    
  </li>

          
        
          
            
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontributingdocswriting-docs-li">
    
      <input type="checkbox" id="m-docscontributingdocswriting-docs-check"/>
      <label for="m-docscontributingdocswriting-docs-check"><a href="/docs/contributing/docs/writing-docs/" title="Docs from the ground up" class="align-left pl-0  td-sidebar-link td-sidebar-link__page" id="m-docscontributingdocswriting-docs"><span class="">Writing docs</span></a></label>
    
    
  </li>

          
        
      </ul>
    
  </li>

          
        
      </ul>
    
  </li>

          
        
      </ul>
    
  </li>

    </ul>
  </nav>
</div>




          </aside>
          
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
  
  
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
    
    
      
    
    
    
    
    
    
    

    
    <a href="https://github.com/fluxcd/website/edit/main/content/zh-cn/docs/iac/helmreleases.md" target="_blank"><i class="fa fa-edit fa-fw"></i> </a>
    <a href="https://github.com/fluxcd/website/new/main/content/zh-cn/docs/iac/helmreleases.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> </a>
    
    <a href="https://github.com/fluxcd/website/issues/new?title=Manage%20Helm%20Releases" target="_blank"><i class="fab fa-github fa-fw"></i> </a>
    
      
      <a href="https://github.com/fluxcd/flux2/issues/new" target="_blank"><i class="fas fa-tasks fa-fw"></i> </a>
    

  
  
  </div>


            


<div class="td-toc"><nav id="TableOfContents">
  <ul>
    <li><a href="#prerequisites">Prerequisites</a></li>
    <li><a href="#define-a-chart-source">Define a chart source</a>
      <ul>
        <li><a href="#helm-repository">Helm repository</a></li>
        <li><a href="#git-repository">Git repository</a></li>
        <li><a href="#cloud-storage">Cloud Storage</a></li>
      </ul>
    </li>
    <li><a href="#define-a-helm-release">Define a Helm release</a></li>
    <li><a href="#refer-to-values-in-configmap-and-secret-resources">Refer to values in <code>ConfigMap</code> and <code>Secret</code> resources</a></li>
    <li><a href="#refer-to-values-in-configmaps-generated-with-kustomize">Refer to values in <code>ConfigMaps</code> generated with Kustomize</a></li>
    <li><a href="#refer-to-values-inside-the-chart">Refer to values inside the chart</a></li>
    <li><a href="#configure-notifications">Configure notifications</a></li>
    <li><a href="#configure-webhook-receivers">Configure webhook receivers</a></li>
  </ul>
</nav></div>



            

	
		



  
  

	
		



  
  

	

          </aside>
          
          
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
          
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="/docs/">道场</a>
</li>




<li class="breadcrumb-item" >
	<a href="/docs/iac/">IaC</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="/docs/iac/helmreleases/">Manage Helm Releases</a>
</li>

	</ol>
</nav	>

            
            
<div class="td-content">
	<h1>Manage Helm Releases</h1>
	<div class="lead">Manage Helm Releases in a declarative manner with Flux.</div>
	<header class="article-meta">
		
		
			
				


			
				


			
		
		
	</header>    
	<p>The 
<a href="../components/helm/_index.md">helm-controller</a> allows you to
declaratively manage Helm chart releases with Kubernetes manifests.
It makes use of the artifacts produced by the

<a href="../components/source/_index.md">source-controller</a> from
<code>HelmRepository</code>, <code>GitRepository</code>, <code>Bucket</code> and <code>HelmChart</code> resources.
The helm-controller is part of the default toolkit installation.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>To follow this guide you&rsquo;ll need a Kubernetes cluster with the GitOps
toolkit controllers installed on it.
Please see the 
<a href="/docs/get-started/">get started guide</a>
or the 
<a href="../installation/">installation guide</a>.</p>
<h2 id="define-a-chart-source">Define a chart source</h2>
<p>To be able to release a Helm chart, the source that contains the chart
(either a <code>HelmRepository</code>, <code>GitRepository</code>, or <code>Bucket</code>) has to be known
first to the source-controller, so that the <code>HelmRelease</code> can reference
to it.</p>
<h3 id="helm-repository">Helm repository</h3>
<p>Helm repositories are the recommended source to retrieve Helm charts
from, as they are lightweight in processing and make it possible to
configure a semantic version selector for the chart version that should
be released.</p>
<p>They can be declared by creating a <code>HelmRepository</code> resource, the
source-controller will fetch the Helm repository index for this
resource on an interval and expose it as an artifact:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>source.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">url</span>:<span style="color:#bbb"> </span>https://stefanprodan.github.io/podinfo<span style="color:#bbb">
</span></code></pre></div><p>The <code>interval</code> defines at which interval the Helm repository index
is fetched, and should be at least <code>1m</code>. Setting this to a higher
value means newer chart versions will be detected at a slower pace,
a push-based fetch can be introduced using 
<a href="/docs/iac/webhook-receivers/">webhook receivers</a></p>
<p>The <code>url</code> can be any HTTP/S Helm repository URL.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Authentication</h4>

    HTTP/S basic and TLS authentication can be configured for private
Helm repositories. See the 
<a href="../components/source/helmrepositories.md"><code>HelmRepository</code> CRD docs</a>
for more details.

</div>

<h3 id="git-repository">Git repository</h3>
<p>Charts from Git repositories can be released by declaring a
<code>GitRepository</code>, the source-controller will fetch the contents of the
repository on an interval and expose it as an artifact.</p>
<p>The source-controller can build and expose Helm charts as artifacts
from the contents of the <code>GitRepository</code> artifact (more about this
later on in the guide).</p>
<p><strong>There is one caveat you should be aware of:</strong> to make the
source-controller produce a new chart artifact, the <code>version</code> in the
<code>Chart.yaml</code> of the chart must be bumped.</p>
<p>An example <code>GitRepository</code>:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>source.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>GitRepository<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">url</span>:<span style="color:#bbb"> </span>https://github.com/stefanprodan/podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">ref</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">branch</span>:<span style="color:#bbb"> </span>master<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">ignore</span>:<span style="color:#bbb"> </span>|<span style="color:#4070a0;font-style:italic">
</span><span style="color:#4070a0;font-style:italic">    # exclude all
</span><span style="color:#4070a0;font-style:italic">    /*
</span><span style="color:#4070a0;font-style:italic">    # include charts directory
</span><span style="color:#4070a0;font-style:italic">    !/charts/</span><span style="color:#bbb">    
</span></code></pre></div><p>The <code>interval</code> defines at which interval the Git repository contents
are fetched, and should be at least <code>1m</code>. Setting this to a higher
value means newer chart versions will be detected at a slower pace,
a push-based fetch can be introduced using 
<a href="/docs/iac/webhook-receivers/">webhook receivers</a></p>
<p>The <code>url</code> can be any HTTP/S or SSH address (the latter requiring
authentication).</p>
<p>The <code>ref</code> defines the checkout strategy, and is set to follow the
<code>master</code> branch in the above example. For other strategies like
tags or commits, see the 
<a href="../components/source/gitrepositories.md"><code>GitRepository</code> CRD docs</a>.</p>
<p>The <code>ignore</code> defines file and folder exclusion for the
artifact produced, and follows the 
<a href="https://git-scm.com/docs/gitignore#_pattern_format" target="_blank"><code>.gitignore</code> pattern
format</a>.
The above example only includes the <code>charts</code> directory of the
repository and omits all other files.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Authentication</h4>

    HTTP/S basic and SSH authentication can be configured for private
Git repositories. See the 
<a href="../components/source/gitrepositories.md"><code>GitRepository</code> CRD docs</a>
for more details.

</div>

<h3 id="cloud-storage">Cloud Storage</h3>
<p>It is inadvisable while still possible to use a <code>Bucket</code> as a source for a <code>HelmRelease</code>,
as the whole storage bucket will be downloaded by source controller at each sync. The
bucket can easily become very large if there are frequent releases of multiple charts
that are stored in the same bucket.</p>
<p>A better option is to use 
<a href="https://github.com/helm/chartmuseum" target="_blank">Chartmuseum</a> and run a cluster
local Helm repository that can be used by source controller. Chartmuseum has support
for multiple different cloud storage solutions such as S3, GCS, and Azure Blob Storage,
meaning that you are not limited to only using storage providers that support the S3 protocol.</p>
<p>You can deploy a Chartmuseum instance with a <code>HelmRelease</code> that exposes a Helm repository stored
in a S3 bucket. Please refer to 
<a href="https://chartmuseum.com/docs/#how-to-run" target="_blank">Chartmuseums how to run documentation</a>
for details about how to use other storage backends.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>source.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>chartmuseum<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">url</span>:<span style="color:#bbb"> </span>https://chartmuseum.github.io/charts<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>10m<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#0e84b5;font-weight:bold">---</span><span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>helm.toolkit.fluxcd.io/v2beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>chartmuseum<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb"> </span>chartmuseum<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;2.14.2&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">sourceRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>chartmuseum<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">values</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">env</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">open</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">AWS_SDK_LOAD_CONFIG</span>:<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">STORAGE</span>:<span style="color:#bbb"> </span>amazon<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">STORAGE_AMAZON_BUCKET</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;bucket-name&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">STORAGE_AMAZON_PREFIX</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">STORAGE_AMAZON_REGION</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;region-name&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">serviceAccount</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">create</span>:<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">annotations</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">eks.amazonaws.com/role-arn</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#34;role-arn&#34;</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">securityContext</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">enabled</span>:<span style="color:#bbb"> </span><span style="color:#007020;font-weight:bold">true</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">fsGroup</span>:<span style="color:#bbb"> </span><span style="color:#40a070">65534</span><span style="color:#bbb">
</span></code></pre></div><p>After Chartmuseum is up and running it should be possible to use the accompanying
service as the url for the <code>HelmRepository</code>.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>source.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>helm-charts<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">url</span>:<span style="color:#bbb"> </span>http://chartmuseum-chartmuseum:8080<span style="color:#bbb">
</span></code></pre></div><h2 id="define-a-helm-release">Define a Helm release</h2>
<p>With the chart source created, define a new <code>HelmRelease</code> to release
the Helm chart:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>helm.toolkit.fluxcd.io/v2beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb"> </span>&lt;name|path&gt;<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">version</span>:<span style="color:#bbb"> </span><span style="color:#4070a0">&#39;4.0.x&#39;</span><span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">sourceRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>&lt;HelmRepository|GitRepository|Bucket&gt;<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>1m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">values</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">replicaCount</span>:<span style="color:#bbb"> </span><span style="color:#40a070">2</span><span style="color:#bbb">
</span></code></pre></div><p>The <code>chart.spec</code> values are used by the helm-controller as a template
to create a new <code>HelmChart</code> resource in the same namespace as the
<code>sourceRef</code>. The source-controller will then lookup the chart in the
artifact of the referenced source, and either fetch the chart for a
<code>HelmRepository</code>, or build it from a <code>GitRepository</code> or <code>Bucket</code>.
It will then make it available as a <code>HelmChart</code> artifact to be used by
the helm-controller.</p>
<p>The <code>chart.spec.chart</code> can either contain:</p>
<ul>
<li>The name of the chart as made available by the <code>HelmRepository</code>
(without any aliases), for example: <code>podinfo</code></li>
<li>The relative path the chart can be found at in the <code>GitRepository</code>
or <code>Bucket</code>, for example: <code>./charts/podinfo</code></li>
<li>The relative path the chart package can be found at in the
<code>GitRepository</code> or <code>Bucket</code>, for example: <code>./charts/podinfo-1.2.3.tgz</code></li>
</ul>
<p>The <code>chart.spec.version</code> can be a fixed semver, or any semver range
(i.e. <code>&gt;=4.0.0 &lt;5.0.0</code>). It is only taken into account for <code>HelmRelease</code>
resources that reference a <code>HelmRepository</code> source.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Advanced configuration</h4>

    The <code>HelmRelease</code> offers an extensive set of configurable flags
for finer grain control over how Helm actions are performed.
See the 
<a href="../components/helm/helmreleases.md"><code>HelmRelease</code> CRD docs</a>
for more details.

</div>

<h2 id="refer-to-values-in-configmap-and-secret-resources">Refer to values in <code>ConfigMap</code> and <code>Secret</code> resources</h2>
<p>It is possible to define a list of <code>ConfigMap</code> and <code>Secret</code> resources
from which to take values. The values are merged in the order given,
with the later values overwriting earlier. These values always have a
lower priority than the values inlined in the <code>HelmRelease</code> via the
<code>spec.values</code> parameter.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">valuesFrom</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ConfigMap<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>prod-env-values<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">valuesKey</span>:<span style="color:#bbb"> </span>values-prod.yaml<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Secret<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>prod-tls-values<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">valuesKey</span>:<span style="color:#bbb"> </span>crt<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">targetPath</span>:<span style="color:#bbb"> </span>tls.crt<span style="color:#bbb">
</span></code></pre></div><p>The definition of the listed keys is as follows:</p>
<ul>
<li><code>kind</code>: Kind of the values referent (<code>ConfigMap</code> or <code>Secret</code>).</li>
<li><code>name</code>: Name of the values referent, in the same namespace as the
<code>HelmRelease</code>.</li>
<li><code>valuesKey</code> <em>(Optional)</em>: The data key where the values.yaml or a
specific value can be found. Defaults to <code>values.yaml</code> when omitted.</li>
<li><code>targetPath</code> <em>(Optional)</em>: The YAML dot notation path at which the
value should be merged. When set, the <code>valuesKey</code> is expected to be
a single flat value. Defaults to <code>None</code> when omitted, which results
in the values getting merged at the root.</li>
</ul>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Note</h4>

    The <code>targetPath</code> supports the same formatting as you would supply
as an argument to the <code>helm</code> binary using <code>--set [path]=[value]</code>.
In addition to this, the referred value can contain the same
value formats (e.g. <code>{a,b,c}</code> for a list).
You can read more about the available formats and limitations in
the 
<a href="https://helm.sh/docs/intro/using_helm/#the-format-and-limitations-of---set" target="_blank">Helm documentation</a>.

</div>



<div class="alert alert-warning" role="alert">
<h4 class="alert-heading">TargetPath and JSON values</h4>

    <p>When using <code>TargetPath</code> in combination with a JSON string, the
<p><a href="https://github.com/helm/helm/issues/5618" target="_blank">limitations are the same as while using <code>helm</code></a>,
and require you to escape the full JSON string (including <code>=</code>, <code>[</code>, <code>,</code>, <code>.</code>).</p></p>


</div>

<h2 id="refer-to-values-in-configmaps-generated-with-kustomize">Refer to values in <code>ConfigMaps</code> generated with Kustomize</h2>
<p>It is possible to use Kustomize 
<a href="https://kubectl.docs.kubernetes.io/references/kustomize/configmapgenerator/" target="_blank">ConfigMap generator</a>
to trigger a Helm release upgrade every time the encoded values change.</p>
<p>First create a <code>kustomizeconfig.yaml</code> for Kustomize to be able to patch
<code>ConfigMaps</code> referenced in <code>HelmRelease</code> manifests:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">nameReference</span>:<span style="color:#bbb">
</span><span style="color:#bbb"></span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ConfigMap<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">version</span>:<span style="color:#bbb"> </span>v1<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">fieldSpecs</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#062873;font-weight:bold">path</span>:<span style="color:#bbb"> </span>spec/valuesFrom/name<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span></code></pre></div><p>Create a <code>HelmRelease</code> definition that references a <code>ConfigMap</code>:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>helm.toolkit.fluxcd.io/v2beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">releaseName</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">sourceRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">valuesFrom</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ConfigMap<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo-values<span style="color:#bbb">
</span></code></pre></div><p>Create a <code>kustomization.yaml</code> that generates the <code>ConfigMap</code> using our kustomize config:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>kustomize.config.k8s.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Kustomization<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">resources</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- namespace.yaml<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- repository.yaml<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- release.yaml<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">configMapGenerator</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo-values<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">files</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span>- values.yaml=my-values.yaml<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">configurations</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- kustomizeconfig.yaml<span style="color:#bbb">
</span></code></pre></div><p>When 
<a href="../components/kustomize/_index.md">kustomize-controller</a> reconciles the above manifests, it will generate
a unique name of the <code>ConfigMap</code> every time <code>my-values.yaml</code> content is updated in Git:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>helm.toolkit.fluxcd.io/v2beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">valuesFrom</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>ConfigMap<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo-values-2mh2t8m94h<span style="color:#bbb">
</span></code></pre></div>

<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Garbage Collection</h4>

    <p>Stale <code>ConfigMaps</code>, previously generated by Kustomize, will be
removed from the cluster by kustomize-controller if
<p><a href="../components/kustomize/kustomization/#garbage-collection">pruning</a> is enabled.</p></p>


</div>

<h2 id="refer-to-values-inside-the-chart">Refer to values inside the chart</h2>
<p>It is possible to replace the <code>values.yaml</code> with a different file present inside the Helm chart.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>helm.toolkit.fluxcd.io/v2beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>mongodb<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>mongodb<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">interval</span>:<span style="color:#bbb"> </span>5m<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">chart</span>:<span style="color:#bbb"> </span>mongodb<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">sourceRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb">        </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>bitnami<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">valuesFiles</span>:<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- values.yaml<span style="color:#bbb">
</span><span style="color:#bbb">        </span>- values-production.yaml<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">values</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">replicaCount</span>:<span style="color:#bbb"> </span><span style="color:#40a070">5</span><span style="color:#bbb">
</span></code></pre></div><p>If the <code>spec.chart.spec.valuesFiles</code> doesn&rsquo;t exists inside the chart, helm-controller will not be able to
fetch the chart. To determine why the <code>HelmChart</code> fails to produce an artifact, you can inspect the status with:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kubectl get helmcharts --all-namespaces
NAME    READY   STATUS
mongodb False   failed to locate override values file: values-prod.yaml
</code></pre></div><h2 id="configure-notifications">Configure notifications</h2>
<p>The default toolkit installation configures the helm-controller to
broadcast events to the 
<a href="../components/notification/_index.md">notification-controller</a>.</p>
<p>To receive the events as notifications, a <code>Provider</code> needs to be setup
first as described in the 
<a href="/docs/iac/notifications/#define-a-provider">notifications guide</a>.
Once you have set up the <code>Provider</code>, create a new <code>Alert</code> resource in
the <code>flux-system</code> to start receiving notifications about the Helm
release:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>notification.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Alert<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">generation</span>:<span style="color:#bbb"> </span><span style="color:#40a070">2</span><span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>helm-podinfo<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">providerRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>slack<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">eventSeverity</span>:<span style="color:#bbb"> </span>info<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">eventSources</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmChart<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>default-podinfo<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRelease<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>default<span style="color:#bbb">
</span></code></pre></div><p><img src="/img/helm-controller-alerts.png" alt="helm-controller alerts"></p>
<h2 id="configure-webhook-receivers">Configure webhook receivers</h2>
<p>When using semver ranges for Helm releases, you may want to trigger an update
as soon as a new chart version is published to your Helm repository.
In order to notify source-controller about a chart update,
you can 
<a href="/docs/iac/webhook-receivers/">setup webhook receivers</a>.</p>
<p>First generate a random string and create a secret with a <code>token</code> field:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#bb60d5">TOKEN</span><span style="color:#666">=</span><span style="color:#007020;font-weight:bold">$(</span>head -c <span style="color:#40a070">12</span> /dev/urandom | shasum | cut -d <span style="color:#4070a0">&#39; &#39;</span> -f1<span style="color:#007020;font-weight:bold">)</span>
<span style="color:#007020">echo</span> <span style="color:#bb60d5">$TOKEN</span>

kubectl -n flux-system create secret generic webhook-token <span style="color:#4070a0;font-weight:bold">\
</span><span style="color:#4070a0;font-weight:bold"></span>--from-literal<span style="color:#666">=</span><span style="color:#bb60d5">token</span><span style="color:#666">=</span><span style="color:#bb60d5">$TOKEN</span>
</code></pre></div><p>When using 
<a href="https://goharbor.io/" target="_blank">Harbor</a> as your Helm repository, you can define a receiver with:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:bold">apiVersion</span>:<span style="color:#bbb"> </span>notification.toolkit.fluxcd.io/v1beta1<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>Receiver<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">metadata</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>helm-podinfo<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">namespace</span>:<span style="color:#bbb"> </span>flux-system<span style="color:#bbb">
</span><span style="color:#bbb"></span><span style="color:#062873;font-weight:bold">spec</span>:<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">type</span>:<span style="color:#bbb"> </span>harbor<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">secretRef</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>webhook-token<span style="color:#bbb">
</span><span style="color:#bbb">  </span><span style="color:#062873;font-weight:bold">resources</span>:<span style="color:#bbb">
</span><span style="color:#bbb">    </span>- <span style="color:#062873;font-weight:bold">kind</span>:<span style="color:#bbb"> </span>HelmRepository<span style="color:#bbb">
</span><span style="color:#bbb">      </span><span style="color:#062873;font-weight:bold">name</span>:<span style="color:#bbb"> </span>podinfo<span style="color:#bbb">
</span></code></pre></div><p>The notification-controller generates a unique URL using the provided token and the receiver name/namespace.</p>
<p>Find the URL with:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">$ kubectl -n flux-system get receiver/helm-podinfo

NAME           READY   STATUS
helm-podinfo   True    Receiver initialised with URL: /hook/bed6d00b5555b1603e1f59b94d7fdbca58089cb5663633fb83f2815dc626d92b
</code></pre></div><p>Log in to the Harbor interface, go to Projects, select a project, and select Webhooks.
Fill the form with:</p>
<ul>
<li>Endpoint URL: compose the address using the receiver LB and the generated URL <code>http://&lt;LoadBalancerAddress&gt;/&lt;ReceiverURL&gt;</code></li>
<li>Auth Header: use the <code>token</code> string</li>
</ul>
<p>With the above settings, when you upload a chart, the following happens:</p>
<ul>
<li>Harbor sends the chart push event to the receiver address</li>
<li>Notification controller validates the authenticity of the payload using the auth header</li>
<li>Source controller is notified about the changes</li>
<li>Source controller pulls the changes into the cluster and updates the <code>HelmChart</code> version</li>
<li>Helm controller is notified about the version change and upgrades the release</li>
</ul>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Note</h4>

    Besides Harbor, you can define receivers for <strong>GitHub</strong>, <strong>GitLab</strong>, <strong>Bitbucket</strong>
and any other system that supports webhooks e.g. Jenkins, CircleCI, etc.
See the 
<a href="../components/notification/receiver.md">Receiver CRD docs</a> for more details.

</div>


	
	
	<div class="text-muted mt-5 pt-3 border-top">

</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Twitter" aria-label="Twitter">
    <a class="text-white" target="_blank" rel="noopener" href="https://twitter.com/fluxcd" aria-label="Twitter">
      <i class="fab fa-twitter"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="LinkedIn" aria-label="LinkedIn">
    <a class="text-white" target="_blank" rel="noopener" href="https://linkedin.com/groups/8985374" aria-label="LinkedIn">
      <i class="fab fa-linkedin"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="RSS Feed" aria-label="RSS Feed">
    <a class="text-white" target="_blank" rel="noopener" href="/blog/index.xml" aria-label="RSS Feed">
      <i class="fa fa-rss"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Support" aria-label="Support">
    <a class="text-white" target="_blank" rel="noopener" href="/support" aria-label="Support">
      <i class="fas fa-comments"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Flux project on GitHub" aria-label="Flux project on GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/fluxcd" aria-label="Flux project on GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://cloud-native.slack.com/messages/flux" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Developer mailing list" aria-label="Developer mailing list">
    <a class="text-white" target="_blank" rel="noopener" href="https://lists.cncf.io/g/cncf-flux-dev" aria-label="Developer mailing list">
      <i class="fa fa-envelope"></i>
    </a>
  </li>
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Flux YouTube channel" aria-label="Flux YouTube channel">
    <a class="text-white" target="_blank" rel="noopener" href="https://www.youtube.com/channel/UCoZxt-YMhGHb20ZkvcCc5KA" aria-label="Flux YouTube channel">
      <i class="fab fa-youtube"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 The Flux authors </small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 











<script src="/js/main.min.5c74b870c6953931a705f390a49c7e4c0a842ec5c83b24354758dd674343ed0d.js" integrity="sha256-XHS4cMaVOTGnBfOQpJx&#43;TAqELsXIOyQ1R1jdZ0ND7Q0=" crossorigin="anonymous"></script>



<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: '45f9f14d53600b0a2cafa46a26ee10f4',
indexName: 'fluxcd',
inputSelector: '.td-search-input',

algoliaOptions: { 'facetFilters': ["tags:current"] },

debug: false 
});
</script>



  </body>
</html>